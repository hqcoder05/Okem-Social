@model okem_social.Models.User
@{
    ViewData["Title"] = Model.FullName;

    bool isOwner     = ViewBag.IsOwner     ?? false;
    bool isFollowing = ViewBag.IsFollowing ?? false;

    string handle = ViewBag.Handle    ?? ("@" + (Model.Email?.Split('@')[0] ?? "user"));
    string avatar = ViewBag.AvatarUrl ?? "/img/avatar-default.png";

    int posts     = ViewBag.PostsCount     ?? 0;
    int followers = ViewBag.FollowersCount ?? 0;
    int following = ViewBag.FollowingCount ?? 0;
}

<div class="container ig-profile py-4">

    <!-- Header: avatar + tên + nút -->
    <div class="row align-items-center g-4">
        <div class="col-4 col-md-3 col-lg-2 d-flex justify-content-center">
            <div class="ig-avatar-ring">
                <img src="@avatar" class="ig-avatar" alt="avatar">
            </div>
        </div>

        <div class="col-8 col-md-9 col-lg-10">
            <div class="d-flex align-items-center flex-wrap gap-2 mb-2">
                <h4 class="mb-0 me-2">@handle</h4>

                @if (isOwner)
                {
                    <a class="btn btn-ig" asp-controller="Profile" asp-action="Me">Edit profile</a>
                    <a class="btn btn-ig" href="#">View archive</a>
                    <button class="btn btn-ig icon-only" type="button" title="Settings" aria-label="Settings">
                        <!-- gear svg -->
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M12 15.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7Z" stroke="currentColor" stroke-width="1.6"/><path d="M19.4 15a7.8 7.8 0 0 0 .1-6l2-1.2-2-3.4-2.3 1a7.9 7.9 0 0 0-5-.9L9.8 1H6.2L6 4.5a7.8 7.8 0 0 0-4 3l-2-.8L0 10l2.2 1a7.9 7.9 0 0 0 .1 2l-2.2 1 0 2.3 2 .8a7.8 7.8 0 0 0 4 3l.2 3.5h3.6l.4-3.6a7.9 7.9 0 0 0 5-.9l2.3 1 2-3.4-2-1.2Z" stroke="currentColor" stroke-width="1.2" opacity=".35"/></svg>
                    </button>
                }
                else if (User.Identity?.IsAuthenticated == true)
                {
                    <form class="d-inline" method="post"
                          asp-controller="Users"
                          asp-action="@(isFollowing ? "Unfollow" : "Follow")"
                          asp-route-id="@Model.Id">
                        @Html.AntiForgeryToken()
                        <button class="btn btn-ig @(isFollowing ? "btn-ig-outline" : "btn-ig-primary")" type="submit">
                            @(isFollowing ? "Following" : "Follow")
                        </button>
                    </form>
                }
            </div>

            <ul class="list-inline ig-stats mb-2">
                <li class="list-inline-item"><b>@posts</b> posts</li>
                <li class="list-inline-item">
                    <a asp-controller="Users" asp-action="Followers" asp-route-id="@Model.Id">
                        <b>@followers</b> followers
                    </a>
                </li>
                <li class="list-inline-item">
                    <a asp-controller="Users" asp-action="Following" asp-route-id="@Model.Id">
                        <b>@following</b> following
                    </a>
                </li>
            </ul>

            <div class="fw-semibold">@Model.FullName</div>
            <div class="ig-handle-chip">@handle</div>
            <div class="text-muted small">my best friend is AI</div> <!-- bạn có thể bind Bio sau -->
        </div>
    </div>

    <!-- Highlights (story) -->
    <div class="ig-highlights my-4">
        <div class="ig-highlight">
            <div class="ring"><img src="@avatar" alt=""></div>
            <div class="caption">The Moment</div>
        </div>
        <div class="ig-highlight">
            <div class="ring empty"><span>+</span></div>
            <div class="caption">New</div>
        </div>
    </div>

    <!-- Tabs -->
    <div class="ig-tabs">
        <button class="tab active">
            <!-- grid icon -->
            <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><path d="M3 3h7v7H3V3Zm11 0h7v7h-7V3ZM3 14h7v7H3v-7Zm11 0h7v7h-7v-7Z"/></svg>
            <span>Posts</span>
        </button>
        <button class="tab">
            <!-- reels icon -->
            <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><path d="M3 7a4 4 0 0 1 4-4h10a4 4 0 0 1 4 4v10a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V7Zm4-2 3 4m2-4 3 4" opacity=".6"/></svg>
            <span>Reels</span>
        </button>
        <button class="tab">
            <!-- tagged icon -->
            <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><path d="M4 4h16v16H4z" opacity=".2"/><path d="M12 7a5 5 0 1 0 .001 10.001A5 5 0 0 0 12 7Zm0 2.2A2.8 2.8 0 1 1 12 15.8 2.8 2.8 0 0 1 12 9.2Z"/></svg>
            <span>Tagged</span>
        </button>
    </div>
    <hr class="ig-sep"/>

    <!-- Grid bài (placeholder) -->
    <div class="ig-grid">
        <div class="ig-grid-empty text-muted">Chưa có bài viết</div>
        @* Khi có dữ liệu ảnh, render:
        <a class="ig-item" href="#"><img src="/img/demo1.jpg" alt=""></a>
        <a class="ig-item" href="#"><img src="/img/demo2.jpg" alt=""></a>
        ... *@
    </div>
</div>
